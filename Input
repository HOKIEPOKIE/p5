package project5;

import java.io.File;
import java.io.FileNotFoundException;
import java.util.ArrayList;
import java.util.Scanner;

public class Input
{
    private static final String COMMA_DELIMITER = ",";

    private static Scanner scanner;
    private static ArrayList<Song> array;
    private static Scanner data;


    public static void main(String args[])
    {
        array = new ArrayList<Song>();
        try
        {
            scanner = new Scanner(new File("SongListTest1.csv"));
            data = new Scanner(new File("MusicSurveyDataTest1.csv"));
            scanner.nextLine(); // also skips banner
            data.nextLine();
            while (scanner.hasNextLine())
            {
                array.add(makeSong()); // adds songs to arrayList.
            }
            while (data.hasNextLine())
            {
                makeAndAdd();
            }

        }
        catch (FileNotFoundException fe)
        {
            fe.printStackTrace();
        }
        finally
        {
            scanner.close();
            data.close();
        }
        sortByGenre();
        sortByTitle();
        // This point on is not permanent and will change as progress continues
        // to reflect the implementation of buttons and so on.

    }


    public static void sortByGenre()
    {
        ArrayList<Song> genre = sortedList(SongSorting.GENRE);
        for (int i = 0; i < genre.size(); i++)
        {
            Song song = genre.get(i); // reference the current song
            System.out.println("Song Title: " + song.getTitle());
            System.out.println("Song Artist: " + song.getArtist());
            System.out.println("Song Genre: " + song.getGenre());
            System.out.println("Song Year: " + song.getYear());
            System.out.println("Heard");
            ArrayList<Participant> heard = song.getList("heard");
            ArrayList<Participant> noHeard = song.getList("noheard");
            int reading = song.getHobbyCount(heard, Hobby.READING);
            int art = song.getHobbyCount(heard, Hobby.ART);
            int sports = song.getHobbyCount(heard, Hobby.SPORTS);
            int music = song.getHobbyCount(heard, Hobby.MUSIC);
            int noHeardRead = song.getHobbyCount(noHeard, Hobby.READING);
            int noHeardArt = song.getHobbyCount(noHeard, Hobby.ART);
            int noHeardSport = song.getHobbyCount(noHeard, Hobby.SPORTS);
            int noHeardMusic = song.getHobbyCount(noHeard, Hobby.MUSIC);

            reading = doMath(reading, noHeardRead);
            art = doMath(art, noHeardArt);
            sports = doMath(sports, noHeardSport);
            music = doMath(music, noHeardMusic);

            System.out.println("reading:" + reading + " art:" + art + " sports:"
                + sports + " music:" + music);

            System.out.println("Likes");
            ArrayList<Participant> like = song.getList("like");
            ArrayList<Participant> noLike = song.getList("nolike");
            int likeRead = song.getHobbyCount(like, Hobby.READING);
            int likeArt = song.getHobbyCount(like, Hobby.ART);
            int likeSports = song.getHobbyCount(like, Hobby.SPORTS);
            int likeMusic = song.getHobbyCount(like, Hobby.MUSIC);

            int noLikeRead = song.getHobbyCount(noLike, Hobby.READING);
            int noLikeArt = song.getHobbyCount(noLike, Hobby.ART);
            int noLikeSport = song.getHobbyCount(noLike, Hobby.SPORTS);
            int noLikeMusic = song.getHobbyCount(noLike, Hobby.MUSIC);

            likeRead = doMath(likeRead, noLikeRead);
            likeArt = doMath(likeArt, noLikeArt);
            likeSports = doMath(likeSports, noLikeSport);
            likeMusic = doMath(likeMusic, noLikeMusic);
            System.out.println("reading:" + likeRead + " art:" + likeArt
                + " sports:" + likeSports + " music:" + likeMusic);
            System.out.println();
        }
    }


    public static void sortByTitle()
    {
        ArrayList<Song> title = sortedList(SongSorting.TITLE);
        for (int i = 0; i < title.size(); i++)
        {
            Song song = title.get(i); // reference the current song
            System.out.println("Song Title: " + song.getTitle());
            System.out.println("Song Artist: " + song.getArtist());
            System.out.println("Song Genre: " + song.getGenre());
            System.out.println("Song Year: " + song.getYear());
            System.out.println("Heard");
            ArrayList<Participant> heard = song.getList("heard");
            ArrayList<Participant> noHeard = song.getList("noheard");
            int reading = song.getHobbyCount(heard, Hobby.READING);
            int art = song.getHobbyCount(heard, Hobby.ART);
            int sports = song.getHobbyCount(heard, Hobby.SPORTS);
            int music = song.getHobbyCount(heard, Hobby.MUSIC);
            int noHeardRead = song.getHobbyCount(noHeard, Hobby.READING);
            int noHeardArt = song.getHobbyCount(noHeard, Hobby.ART);
            int noHeardSport = song.getHobbyCount(noHeard, Hobby.SPORTS);
            int noHeardMusic = song.getHobbyCount(noHeard, Hobby.MUSIC);

            reading = doMath(reading, noHeardRead);
            art = doMath(art, noHeardArt);
            sports = doMath(sports, noHeardSport);
            music = doMath(music, noHeardMusic);

            System.out.println("reading:" + reading + " art:" + art + " sports:"
                + sports + " music:" + music);

            System.out.println("Likes");
            ArrayList<Participant> like = song.getList("like");
            ArrayList<Participant> noLike = song.getList("nolike");
            int likeRead = song.getHobbyCount(like, Hobby.READING);
            int likeArt = song.getHobbyCount(like, Hobby.ART);
            int likeSports = song.getHobbyCount(like, Hobby.SPORTS);
            int likeMusic = song.getHobbyCount(like, Hobby.MUSIC);

            int noLikeRead = song.getHobbyCount(noLike, Hobby.READING);
            int noLikeArt = song.getHobbyCount(noLike, Hobby.ART);
            int noLikeSport = song.getHobbyCount(noLike, Hobby.SPORTS);
            int noLikeMusic = song.getHobbyCount(noLike, Hobby.MUSIC);

            likeRead = doMath(likeRead, noLikeRead);
            likeArt = doMath(likeArt, noLikeArt);
            likeSports = doMath(likeSports, noLikeSport);
            likeMusic = doMath(likeMusic, noLikeMusic);
            System.out.println("reading:" + likeRead + " art:" + likeArt
                + " sports:" + likeSports + " music:" + likeMusic);
            System.out.println();
        }
    }


    private static int doMath(int x, int y)
    {
        if (x == 0)
        {
            return 0;
        }
        else
        {
            return x * 100 / (x + y);
        }
    }


    /**
     * This method
     */
    private static void makeAndAdd()
    {
        Participant part = null;
        String line = data.nextLine();
        Scanner read = new Scanner(line);
        try
        {
            read.useDelimiter(COMMA_DELIMITER);
            read.next();
            read.next();
            Major major = convertMajor(read.next());
            State state = convertState(read.next());
            Hobby hobby = convertHobby(read.next());
            part = new Participant(major, state, hobby);

            if (part.isValid())
            {

                int count = 0;
                while (read.hasNext())
                {
                    String one = read.next();
                    part.setResponse(one);
                    Song song = array.get(count / 2);
                    // reference song lists.
                    ArrayList<Participant> heard = song.getList("heard");
                    ArrayList<Participant> like = song.getList("like");

                    ArrayList<Participant> noHeard = song.getList("noheard");
                    ArrayList<Participant> noLike = song.getList("nolike");
                    if (one.equals("Yes"))// used for yes entry count
                    {

                        if (count % 2 == 0)
                        {
                            song.addToList(heard, part);
                        }
                        else
                        {
                            song.addToList(like, part);
                        }
                    }
                    if (one.equals("No"))// used for total count
                    {
                        if (count % 2 == 0)
                        {
                            song.addToList(noHeard, part);
                        }
                        else
                        {
                            song.addToList(noLike, part);
                        }
                    }
                    count++;
                }

            }
        }
        finally
        {
            read.close();
        }
    }


    /**
     * Just converts what is read in from the scanner, String,
     * to the appropriate enumeration value for Hobby.
     * 
     * @param text
     *            the String read in from scanner.
     * @return the enumeration value of Hobby.
     */
    private static Hobby convertHobby(String text)
    {
        switch (text)
        {
            case "sports":
                return Hobby.SPORTS;
            case "art":
                return Hobby.ART;
            case "music":
                return Hobby.MUSIC;
            case "reading":
                return Hobby.READING;
            default:
                return null;
        }
    }


    /**
     * Just converts what is read in from the scanner, String,
     * to the appropriate enumeration value for Major.
     * 
     * @param text
     *            the String read in from scanner.
     * @return the enumeration value of Major.
     */
    private static Major convertMajor(String text)
    {
        switch (text)
        {
            case "Computer Science":
                return Major.CS;
            case "Other Engineering":
                return Major.ENGINEER;
            case "Math or CMDA":
                return Major.MATH;
            case "Other":
                return Major.OTHER;
            default:
                return null;
        }
    }


    /**
     * Just converts what is read in from the scanner, String,
     * to the appropriate enumeration value for State.
     * 
     * @param text
     *            the String read in from scanner.
     * @return the enumeration value of State.
     */
    private static State convertState(String text)
    {
        switch (text)
        {
            case "Northeast":
                return State.NE;
            case "Outside of United States":
                return State.OUT;
            case "United States (other than Southeast or Northwest)":
                return State.REST;
            case "Southeast":
                return State.SE;
            default:
                return null;
        }
    }


    /**
     * Helper function used to make a song object to add to a list.
     * 
     * @return Song the song made.
     */
    private static Song makeSong()
    {
        Song song = null;
        String line = scanner.nextLine();
        Scanner data = new Scanner(line);
        try
        {
            data.useDelimiter(COMMA_DELIMITER);
            String name = null;
            String artist = null;
            int year = 0;
            String genre = null;
            while (data.hasNext())
            {
                name = data.next();
                artist = data.next();
                year = Integer.parseInt(data.next());
                genre = data.next();
            }
            song = new Song(name, artist, year, genre);
        }
        finally
        {
            data.close();
        }
        return song;
    }


    /**
     * Creates a comparator with the sort parameter passed to the comparator.
     * Then sorts the array based on a switch case within the comparator.
     * 
     * @param sort
     *            this is the way in which to sort the list.
     * @return ArrayList<Song> this is the updated and sorted list.
     */
    public static ArrayList<Song> sortedList(SongSorting sort)
    {
        MyComparator c = new MyComparator(sort);
        ArrayList<Song> sorted = array;
        sorted.sort(c);
        return sorted;
    }

}
